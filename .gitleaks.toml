# Gitleaks configuration for SealBridge Bootstrap
# This file defines patterns to detect secrets and sensitive data

title = "SealBridge Bootstrap Secrets Detection"

[extend]
# Use default rules
useDefault = true

[[rules]]
id = "sealbridge-master-key"
description = "SealBridge MASTER_KEY pattern"
regex = '''(?i)(master[_-]?key|MASTER[_-]?KEY)\s*[=:]\s*['"]?[a-zA-Z0-9+/=]{32,}['"]?'''
tags = ["sealbridge", "secret", "key"]

[[rules]]
id = "sealbridge-client-secret"
description = "SealBridge client secret pattern"
regex = '''(?i)(client[_-]?secret|CLIENT[_-]?SECRET|sb[_-]?bootstrap[_-]?client[_-]?secret)\s*[=:]\s*['"]?[a-zA-Z0-9+/=]{24,}['"]?'''
tags = ["sealbridge", "secret", "api"]

[[rules]]
id = "sealbridge-totp-secret"
description = "TOTP secret pattern"
regex = '''(?i)(totp[_-]?secret|TOTP[_-]?SECRET)\s*[=:]\s*['"]?[A-Z2-7]{16,}['"]?'''
tags = ["sealbridge", "secret", "totp"]

[[rules]]
id = "age-private-key"
description = "Age encryption private key"
regex = '''AGE-SECRET-KEY-1[QPZry9x8GF2tUVWJNT34fbd67nkm5ghCMXY6KBv78R]'''
tags = ["age", "encryption", "key"]

[[rules]]
id = "ssh-private-key"
description = "SSH private key"
regex = '''-----BEGIN\s+(OPENSSH|RSA|EC|DSA|ED25519)\s+PRIVATE KEY-----'''
tags = ["ssh", "key", "private"]

[[rules]]
id = "generic-api-key"
description = "Generic API key pattern"
regex = '''(?i)(api[_-]?key|apikey)\s*[=:]\s*['"]?[a-zA-Z0-9_\-]{20,}['"]?'''
tags = ["api", "key"]

[[rules]]
id = "aws-access-key"
description = "AWS Access Key ID"
regex = '''AKIA[0-9A-Z]{16}'''
tags = ["aws", "key"]

[[rules]]
id = "aws-secret-key"
description = "AWS Secret Access Key"
regex = '''(?i)aws[_-]?secret[_-]?access[_-]?key\s*[=:]\s*['"]?[A-Za-z0-9/+=]{40}['"]?'''
tags = ["aws", "secret"]

[[rules]]
id = "github-token"
description = "GitHub token"
regex = '''ghp_[a-zA-Z0-9]{36}'''
tags = ["github", "token"]

[[rules]]
id = "github-pat"
description = "GitHub Personal Access Token"
regex = '''gho_[a-zA-Z0-9]{36}'''
tags = ["github", "token", "pat"]

[[rules]]
id = "slack-token"
description = "Slack token"
regex = '''xox[baprs]-[0-9a-zA-Z\-]{10,48}'''
tags = ["slack", "token"]

[[rules]]
id = "google-api-key"
description = "Google API key"
regex = '''AIza[0-9A-Za-z\-]{35}'''
tags = ["google", "api", "key"]

# Disabled: too many false positives for Python code (password=True function parameters)
# [[rules]]
# id = "password-in-code"
# description = "Password in code"
# regex = '''(?i)(password|passwd|pwd)\s*[=:]\s*['"]?[^'"]{8,}['"]?'''
# tags = ["password", "credential"]

[allowlist]
description = "Allowlist for false positives - use baseline for exact matches"
# Only allowlist the config file itself and git metadata
paths = [
  '''\.gitleaks\.toml''',
  '''\.git/''',
]

